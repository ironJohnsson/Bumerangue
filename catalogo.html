<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cat√°logo - Bumerangue</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  --verde:#2e8b57; --verde-esc:#256b46; --fundo:#fffaf0; --card:#f8f8f8;
}
*{box-sizing:border-box}
body{font-family:"Roboto",sans-serif;background:var(--fundo);color:#333;margin:0}
header,footer{background:var(--verde);color:#fff;padding:15px;text-align:center}
nav a{margin:0 15px;color:#fff;text-decoration:none;font-weight:700}
nav a:hover{color:#ffeb3b}
section.categoria{margin:40px auto;max-width:1100px}
.subtitulo{font-size:1.3rem;margin-top:30px;margin-bottom:10px;color:var(--verde-esc);border-bottom:2px solid var(--verde);display:inline-block;padding-bottom:4px}
.catalogo{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;padding:20px}
@media(max-width:900px){.catalogo{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.catalogo{grid-template-columns:1fr}}
.produto{background:var(--card);border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1);overflow:hidden;text-align:center;cursor:pointer;transition:transform .18s}
.produto:hover{transform:scale(1.03)}
.produto img{width:100%;height:200px;object-fit:cover}
.produto h3{color:var(--verde);margin:10px 0}
.produto p{padding:0 10px 15px;color:#666}
#tabelaPrecos{max-width:600px;margin:30px auto;background:var(--card);border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1);padding:15px;display:none}
#tabelaPrecos h3{color:var(--verde);text-align:center;margin-bottom:10px}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:32px;background:#111;color:#fff;padding:12px 18px;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,.3);z-index:1200;opacity:0;pointer-events:none;transition:opacity .2s,transform .2s}
.toast.show{opacity:1;transform:translateX(-50%) translateY(-6px);pointer-events:auto}
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.45);justify-content:center;align-items:center;padding:20px}
.modal.show{display:flex}
.modal-card{background:#fff;border-radius:12px;padding:20px;max-width:480px;width:100%;box-shadow:0 10px 25px rgba(0,0,0,.25);position:relative;text-align:center}
.close{position:absolute;right:14px;top:10px;font-size:20px;color:var(--verde);cursor:pointer;font-weight:700}
.close:hover{color:var(--verde-esc)}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:8px;text-align:center;border-bottom:1px solid #eee}
th{background:var(--verde);color:#fff}
.status-disponivel{color:green;font-weight:700}
.status-indisponivel{color:red;font-weight:700}
button{background:var(--verde);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
button.small{padding:5px 10px;font-size:.9rem;border-radius:6px}
button.ghost{background:transparent;color:var(--verde);border:2px solid var(--verde)}
button.ghost:hover{background:var(--verde);color:#fff}
#carrinhoBtn{position:fixed;right:20px;bottom:20px;background:var(--verde);color:#fff;border-radius:50%;width:60px;height:60px;border:none;font-size:22px;box-shadow:0 8px 20px rgba(0,0,0,.25);cursor:pointer}
</style>
</head>
<body>
<header>
  <h1>Cat√°logo Bumerangue</h1>
  <nav>
    <a href="index.html">In√≠cio</a>
    <a href="catalogo.html">Cat√°logo</a>
    <a href="sobre.html">Sobre</a>
    <a href="contato.html">Contato</a>
  </nav>
</header>

<main>
  <!-- Tabela de pre√ßos (apenas para Bebidas) -->
  <div id="tabelaPrecos">
    <h3>Tabela de Pre√ßos (padr√£o para todos os sabores)</h3>
    <table>
      <thead><tr><th>Tamanho</th><th>Pre√ßo</th></tr></thead>
      <tbody>
        <tr><td>280ml</td><td>R$ 30,00</td></tr>
        <tr><td>500ml</td><td>R$ 55,00</td></tr>
        <tr><td>750ml</td><td>R$ 80,00</td></tr>
        <tr><td>1L</td><td>R$ 100,00</td></tr>
      </tbody>
    </table>
  </div>

  <div id="catalogoContainer"></div>
</main>

<footer><p>&copy; 2025 Bumerangue - Bebidas Artesanais</p></footer>

<!-- Modal produto -->
<div id="produtoModal" class="modal">
  <div class="modal-card">
    <span class="close" id="closeProduto">&times;</span>
    <h2 id="modalNome"></h2>
    <table>
      <thead><tr><th>Tamanho</th><th>Qtde</th><th>A√ß√£o</th></tr></thead>
      <tbody id="modalTabela"></tbody>
    </table>
  </div>
</div>

<button id="carrinhoBtn" title="Ver carrinho">üõí</button>
<div id="toast" class="toast"></div>

<script>
/* === CONFIG === */
const SHEET_ID = "19c63mlSybEumd2qgRciqTOzuXtCs_5eYEa5jXTylKyQ"; // <-- ID da planilha Google
const APP_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwIjG3LEZt_xi0U8Wj0x0C_H-8rkb92nIkXA6uNpBiydGj-aQ4ro4N9BTtQfW42Czi_Ng/exec"; // <-- URL do Apps Script (Parte 2)
const CATEGORIAS = {
  "Bebidas": ["Releitura dos Cl√°ssicos", "Frutas", "Sabores Brasileiros"],
  "Sabonetes": ["Sabonetes"],
  "Doces": ["Doces"]
};
const precos = { "280ml":30, "500ml":55, "750ml":80, "1L":100 };
let produtos = [];
let carrinho = [];

function showToast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg; t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),3000);
}

/* === CARREGAR CAT√ÅLOGO === */
async function carregarCatalogo(){
  const container=document.getElementById("catalogoContainer");
  container.innerHTML="<p style='text-align:center'>‚è≥ Carregando cat√°logo...</p>";
  let html="";

  for(const cat in CATEGORIAS){
    // Mostrar tabela de pre√ßo apenas para BEBIDAS
    const tabela=document.getElementById("tabelaPrecos");
    tabela.style.display = (cat === "Bebidas") ? "block" : "none";

    html += `<section class='categoria'><h2>${cat}</h2>`;
    for(const sub of CATEGORIAS[cat]){
      try{
        const resp=await fetch(`https://opensheet.elk.sh/${SHEET_ID}/${encodeURIComponent(sub)}`);
        const dados=await resp.json();
        if(dados.length===0) continue;
        html += `<h3 class='subtitulo'>${sub}</h3><div class='catalogo'>`;
        dados.forEach((d)=>{
          const produto={
            nome:d.nome,
            descricao:d.descricao,
            imagem:d.imagem||"https://via.placeholder.com/400x200",
            aba:sub,
            estoque:{
              "280ml":+d["280ml"]||0,
              "500ml":+d["500ml"]||0,
              "750ml":+d["750ml"]||0,
              "1L":+d["1L"]||0,
              "N√£o engarrafado":+d["NaoEngarrafado"]||0
            }
          };
          const index=produtos.push(produto)-1;
          html += `<div class='produto' onclick='abrirModal(${index})'>
                    <img src='${produto.imagem}' alt='${produto.nome}'>
                    <h3>${produto.nome}</h3>
                    <p>${produto.descricao}</p></div>`;
        });
        html += "</div>";
      }catch(e){
        html += `<p style='color:red;text-align:center'>Erro ao carregar ${sub}</p>`;
      }
    }
    html += "</section>";
  }
  container.innerHTML=html||"<p style='text-align:center'>Nenhum item dispon√≠vel.</p>";
}

/* === MODAL PRODUTO === */
const modal=document.getElementById("produtoModal");
const modalNome=document.getElementById("modalNome");
const modalTabela=document.getElementById("modalTabela");
document.getElementById("closeProduto").onclick=()=>modal.classList.remove("show");
window.onclick=e=>{if(e.target===modal)modal.classList.remove("show")};

function abrirModal(i){
  const p=produtos[i];
  modalNome.textContent=p.nome;
  modalTabela.innerHTML="";
  for(const t in p.estoque){
    const q=p.estoque[t];
    const status=q>0?"status-disponivel":"status-indisponivel";
    let btn="";
    if(q>0) btn=`<button class='small' onclick="addCarrinho(${i},'${t}')">Adicionar</button>`;
    const display=q>0?(t==="N√£o engarrafado"?`${q} L`:q):"Indispon√≠vel";
    modalTabela.insertAdjacentHTML("beforeend",`<tr><td>${t}</td><td class='${status}'>${display}</td><td>${btn}</td></tr>`);
  }
  modal.classList.add("show");
}

/* === CARRINHO === */
function addCarrinho(i,t){
  const p=produtos[i];
  if(p.estoque[t]<=0){showToast("Indispon√≠vel.");return;}
  p.estoque[t]--;
  carrinho.push({nome:p.nome,tamanho:t,preco:precos[t]||0,aba:p.aba});
  showToast(`${p.nome} (${t}) adicionado.`);
  modal.classList.remove("show");
}

document.getElementById("carrinhoBtn").onclick=async()=>{
  if(carrinho.length===0){showToast("Carrinho vazio.");return;}
  const resumo=carrinho.map(c=>`${c.nome} (${c.tamanho}) - R$${c.preco},00`).join("\n");
  if(confirm("Enviar pedido?\n\n"+resumo)){
    await fetch(APP_SCRIPT_URL,{method:"POST",body:JSON.stringify(carrinho)});
    carrinho=[];
    showToast("Pedido enviado!");
  }
};

/* === IN√çCIO === */
carregarCatalogo();
</script>
</body>
</html>
